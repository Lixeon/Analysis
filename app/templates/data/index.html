{% extends "form.html" %}

{% block styles %}
{{super()}}
<link rel="stylesheet" type="text/css" href="{{ url_for( 'static',filename='css/data.css' )}}">
{% endblock %}

{% block app_content %}
    {% if res %}
        <div class="panel-footer">
            <input id="Machine{{ res }}" type="text" class="form-control" aria-label="...">
            <br>
            <div id="Activaty{{ res }}" class="well well-sm">Machine Status</div>
            <br>
            <span>
                <a class="btn btn-primary" role="button" href="javascript:MachineTest('#Machine{{ res }}','#Activaty{{ res }}',);">{{ _('Run') }}</a>
            </span>
        </div>
    {% else %}
        <h3>{{ _('No Machine Online') }}</h1>
        <p><a class="btn btn-outline-secondary" role="button" href="{{ url_for('main.index') }}">{{ _('Back') }}</a></p>
    {% endif %}
{% endblock %}

{% block scripts %}
    {% if target %}
        <script>
            function MachineTest(sourceElem, destElem) {
                $(destElem).html('<img src="{{ url_for('static', filename='images/loading/loading.gif') }}">');
                $.post("{{ url_for('api.csrf') }}", {
                    "url":"{{ target }}",
                    "machine":"shake"
                }).done(function (response) {
                    $(destElem).text(response['Status'])
                }).fail(function () {
                    $(destElem).text("{{ _('Error: Could not contact server.') }}");
                });
            }
        </script>
    {% endif %}
{{ super() }}

{% endblock %}

